mysql56:
  container_name: mysql56
  build: ./db/mysql56
  ports:
    - "3306:3306"
  restart: always
  environment:
    MYSQL_ROOT_PASSWORD: vagrant
    MYSQL_USER: vagrant
    MYSQL_PASSWORD: vagrant
    MYSQL_DATABASE: myapp
  volumes:
    - ./db/mysql56/db:/var/lib/mysql
    - ./db/mysql56/logs:/var/log/mysql
  command: 
    - usermod -u 1000 mysql
mongo:
  container_name: mongo
  image: mongo
  volumes:
    - ./db/mongo/data:/data/db
solr:
    image: solr
    ports:
        - "8983:8983"
    volumes:
        # before running create solr/data and chown 8983:8983 it.
        - ./db/solr/data:/opt/solr/server/solr/mycores
    entrypoint:
      - docker-entrypoint.sh
      - solr-precreate
      - mycore
redis:
    image: redis
    ports:
        - "6379:6379"
    volumes:
        - ./db/redis/data:/data
phpmyadmin:
  image: corbinu/docker-phpmyadmin
  links:
    - mysql56:mysql
  ports:
    - 8181:80
  environment:
    MYSQL_USERNAME: vagrant
    MYSQL_ROOT_PASSWORD: vagrant
web:
    container_name: web
    hostname: jbox_docker
    build: ./web
    expose:
        - "80"
    links:
        - mysql56:mysql56
        - mongo:mongo
        - redis:redis
    ports:
        - "80:80"
    volumes:
        - ./www:/var/www
        - ./apache/logs/apache2:/var/log/apache2
        - ./apache/sites-enabled:/etc/apache2/sites-enabled



